<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Include Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js"></script>
    <style>
        /* Your existing CSS styles */
    </style>
</head>
<body class="bg-gray-900 text-white p-6">

<h1 class="text-3xl font-bold mb-6">Weekly Planner</h1>

<table class="min-w-full bg-gray-800 border border-gray-700 mb-6">
    <thead>
        <tr class="bg-gray-700">
            <th class="px-6 py-3 border border-gray-600">Date</th>
            <th class="px-6 py-3 border border-gray-600">Image</th>
            <th class="px-6 py-3 border border-gray-600">Social Media Text</th>
            <th class="px-6 py-3 border border-gray-600">Notes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="px-6 py-4 border border-gray-600">Monday</td>
            <td class="px-6 py-4 border border-gray-600 image-cell">
                <button class="bg-blue-600 text-white px-4 py-2 rounded" onclick="document.getElementById('fileInput1').click()">Upload Image</button>
                <input type="file" id="fileInput1" accept="image/*" onchange="uploadImage(event, 'img1')">
                <br>
                <img id="img1" src="" alt="">
            </td>
            <td class="px-6 py-4 border border-gray-600" contenteditable="true"></td>
            <td class="px-6 py-4 border border-gray-600" contenteditable="true"></td>
        </tr>
        <!-- Repeat similar structure for other days -->
    </tbody>
</table>

<button class="bg-red-600 text-white px-4 py-2 rounded" onclick="confirmReset()">Reset All</button>

<script>
    // Initialize Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyC0qP-Nd2_vUMclBs7t_7LRLJT9lPn7dTk",
        authDomain: "planner-a66be.firebaseapp.com",
        projectId: "planner-a66be",
        storageBucket: "planner-a66be.appspot.com",
        messagingSenderId: "275446683353",
        appId: "1:275446683353:web:c7b155b01592b17c9f90c8",
        measurementId: "G-VZ9BQEMJPN"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const storage = firebase.storage();

    function uploadImage(event, imgId) {
        const file = event.target.files[0];
        const storageRef = storage.ref('images/' + file.name);

        storageRef.put(file).then(() => {
            console.log('File uploaded successfully!');
            storageRef.getDownloadURL().then(url => {
                const imgElement = document.getElementById(imgId);
                imgElement.src = url;
                localStorage.setItem(imgId, url);
            });
        }).catch(error => {
            console.error('Error uploading file: ', error);
        });
    }

    function confirmReset() {
        if (confirm("Are you sure you want to reset all the content?")) {
            resetAll();
        }
    }

    function resetAll() {
        const images = document.querySelectorAll('img');
        images.forEach(img => {
            img.src = '';
            localStorage.removeItem(img.id);
        });

        const editableCells = document.querySelectorAll('[contenteditable="true"]');
        editableCells.forEach((cell, index) => {
            cell.innerHTML = '';
            localStorage.removeItem(`editableCell${index}`);
        });

        const fileInputs = document.querySelectorAll('input[type="file"]');
        fileInputs.forEach(input => input.value = '');
    }

    // Restore saved images from localStorage on page load
    document.addEventListener('DOMContentLoaded', () => {
        const images = document.querySelectorAll('img');
        images.forEach(img => {
            const savedImage = localStorage.getItem(img.id);
            if (savedImage) {
                img.src = savedImage;
            }
        });

        const editableCells = document.querySelectorAll('[contenteditable="true"]');
        editableCells.forEach((cell, index) => {
            const savedText = localStorage.getItem(`editableCell${index}`);
            if (savedText) {
                cell.innerHTML = savedText;
            }

            cell.addEventListener('input', () => {
                localStorage.setItem(`editableCell${index}`, cell.innerHTML);
            });
        });
    });
</script>

</body>
</html>
